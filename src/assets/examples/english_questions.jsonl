{"question": "Who is our top-performing sales support agent based on total sales?", "sql": "SELECT E.FirstName, E.LastName, SUM(I.Total) as TotalSales FROM Employee E JOIN Customer C ON E.EmployeeId = C.SupportRepId JOIN Invoice I ON C.CustomerId = I.CustomerId GROUP BY E.EmployeeId ORDER BY TotalSales DESC LIMIT 1;"}
{"question": "What is the total revenue generated from the USA in 2012?", "sql": "SELECT SUM(Total) FROM Invoice WHERE BillingCountry = 'USA' AND strftime('%Y', InvoiceDate) = '2012';"}
{"question": "Which genre has the highest number of tracks in our catalog?", "sql": "SELECT G.Name, COUNT(T.TrackId) as TrackCount FROM Genre G JOIN Track T ON G.GenreId = T.GenreId GROUP BY G.GenreId ORDER BY TrackCount DESC LIMIT 1;"}
{"question": "List the 5 customers who spent the most money in 2013.", "sql": "SELECT C.FirstName, C.LastName, SUM(I.Total) as TotalSpent FROM Customer C JOIN Invoice I ON C.CustomerId = I.CustomerId WHERE strftime('%Y', I.InvoiceDate) = '2013' GROUP BY C.CustomerId ORDER BY TotalSpent DESC LIMIT 5;"}
{"question": "How many tracks does the artist 'Iron Maiden' have in the database?", "sql": "SELECT COUNT(T.TrackId) FROM Track T JOIN Album A ON T.AlbumId = A.AlbumId JOIN Artist Ar ON A.ArtistId = Ar.ArtistId WHERE Ar.Name = 'Iron Maiden';"}
{"question": "What is the average invoice value for customers in Germany?", "sql": "SELECT AVG(Total) FROM Invoice WHERE BillingCountry = 'Germany';"}
{"question": "Show me the contact emails for all customers assigned to agent Jane Peacock.", "sql": "SELECT C.Email FROM Customer C JOIN Employee E ON C.SupportRepId = E.EmployeeId WHERE E.FirstName = 'Jane' AND E.LastName = 'Peacock';"}
{"question": "Which albums cost more than $20 in total?", "sql": "SELECT A.Title, SUM(T.UnitPrice) as AlbumPrice FROM Album A JOIN Track T ON A.AlbumId = T.AlbumId GROUP BY A.AlbumId HAVING AlbumPrice > 20;"}
{"question": "How much revenue did the 'Rock' genre generate?", "sql": "SELECT SUM(IL.UnitPrice * IL.Quantity) FROM InvoiceLine IL JOIN Track T ON IL.TrackId = T.TrackId JOIN Genre G ON T.GenreId = G.GenreId WHERE G.Name = 'Rock';"}
{"question": "Identify the artist with the most albums.", "sql": "SELECT Ar.Name, COUNT(A.AlbumId) as AlbumCount FROM Artist Ar JOIN Album A ON Ar.ArtistId = A.ArtistId GROUP BY Ar.ArtistId ORDER BY AlbumCount DESC LIMIT 1;"}
{"question": "What is the total duration in hours of all tracks in the 'Jazz' genre?", "sql": "SELECT SUM(T.Milliseconds) / 3600000.0 FROM Track T JOIN Genre G ON T.GenreId = G.GenreId WHERE G.Name = 'Jazz';"}
{"question": "List tracks that haven't been sold yet.", "sql": "SELECT Name FROM Track WHERE TrackId NOT IN (SELECT TrackId FROM InvoiceLine);"}
{"question": "Compare sales totals between 2009 and 2010.", "sql": "SELECT strftime('%Y', InvoiceDate) as Year, SUM(Total) FROM Invoice WHERE strftime('%Y', InvoiceDate) IN ('2009', '2010') GROUP BY Year;"}
{"question": "Which media type is the most popular among buyers?", "sql": "SELECT M.Name, COUNT(IL.InvoiceLineId) as SalesCount FROM MediaType M JOIN Track T ON M.MediaTypeId = T.MediaTypeId JOIN InvoiceLine IL ON T.TrackId = IL.TrackId GROUP BY M.MediaTypeId ORDER BY SalesCount DESC LIMIT 1;"}
{"question": "Who is the manager of the IT Staff?", "sql": "SELECT M.FirstName, M.LastName FROM Employee E JOIN Employee M ON E.ReportsTo = M.EmployeeId WHERE E.Title LIKE '%IT%' LIMIT 1;"}
{"question": "Get the phone numbers of all customers who live in 'Prague'.", "sql": "SELECT Phone FROM Customer WHERE City = 'Prague';"}
{"question": "What are the total sales per country for the year 2011?", "sql": "SELECT BillingCountry, SUM(Total) FROM Invoice WHERE strftime('%Y', InvoiceDate) = '2011' GROUP BY BillingCountry;"}
{"question": "Find the playlist that contains the most tracks.", "sql": "SELECT P.Name, COUNT(PT.TrackId) as TrackCount FROM Playlist P JOIN PlaylistTrack PT ON P.PlaylistId = PT.PlaylistId GROUP BY P.PlaylistId ORDER BY TrackCount DESC LIMIT 1;"}
{"question": "How many employees report directly to Nancy Edwards?", "sql": "SELECT COUNT(*) FROM Employee WHERE ReportsTo = (SELECT EmployeeId FROM Employee WHERE FirstName = 'Nancy' AND LastName = 'Edwards');"}
{"question": "What is the most expensive track in terms of unit price?", "sql": "SELECT Name, UnitPrice FROM Track ORDER BY UnitPrice DESC LIMIT 1;"}
{"question": "Which city in France has the most customers?", "sql": "SELECT City, COUNT(*) as CustCount FROM Customer WHERE Country = 'France' GROUP BY City ORDER BY CustCount DESC LIMIT 1;"}
{"question": "Show the total sales for each quarter in 2012.", "sql": "SELECT strftime('%Y', InvoiceDate) || '-Q' || ((strftime('%m', InvoiceDate) + 2) / 3) as Quarter, SUM(Total) FROM Invoice WHERE strftime('%Y', InvoiceDate) = '2012' GROUP BY Quarter;"}
{"question": "List all tracks composed by 'The Rolling Stones' available in AAC audio file format.", "sql": "SELECT T.Name FROM Track T JOIN MediaType M ON T.MediaTypeId = M.MediaTypeId WHERE T.Composer LIKE '%Rolling Stones%' AND M.Name LIKE '%AAC%';"}
{"question": "Who is the customer with the highest number of separate orders (invoices)?", "sql": "SELECT C.FirstName, C.LastName, COUNT(I.InvoiceId) as OrderCount FROM Customer C JOIN Invoice I ON C.CustomerId = I.CustomerId GROUP BY C.CustomerId ORDER BY OrderCount DESC LIMIT 1;"}
{"question": "Calculate the total revenue from 'Latin' music in 2010.", "sql": "SELECT SUM(IL.UnitPrice * IL.Quantity) FROM InvoiceLine IL JOIN Invoice I ON IL.InvoiceId = I.InvoiceId JOIN Track T ON IL.TrackId = T.TrackId JOIN Genre G ON T.GenreId = G.GenreId WHERE G.Name = 'Latin' AND strftime('%Y', I.InvoiceDate) = '2010';"}
{"question": "Which employees were hired in 2003?", "sql": "SELECT FirstName, LastName FROM Employee WHERE strftime('%Y', HireDate) = '2003';"}
{"question": "What is the average length of a track in the album 'Californication'?", "sql": "SELECT AVG(T.Milliseconds) FROM Track T JOIN Album A ON T.AlbumId = A.AlbumId WHERE A.Title = 'Californication';"}
{"question": "List all customers who don't have a dedicated Support Rep.", "sql": "SELECT FirstName, LastName FROM Customer WHERE SupportRepId IS NULL;"}
{"question": "How much data (in bytes) does the 'TV Shows' playlist occupy?", "sql": "SELECT SUM(T.Bytes) FROM Track T JOIN PlaylistTrack PT ON T.TrackId = PT.TrackId JOIN Playlist P ON PT.PlaylistId = P.PlaylistId WHERE P.Name = 'TV Shows';"}
{"question": "Find the artist with the highest total sales revenue.", "sql": "SELECT Ar.Name, SUM(IL.UnitPrice * IL.Quantity) as Revenue FROM Artist Ar JOIN Album A ON Ar.ArtistId = A.ArtistId JOIN Track T ON A.AlbumId = T.AlbumId JOIN InvoiceLine IL ON T.TrackId = IL.TrackId GROUP BY Ar.ArtistId ORDER BY Revenue DESC LIMIT 1;"}